---
title: Uploading Files
description: Upload files, images, and data to decentralized storage
---

import { Aside } from '@astrojs/starlight/components';

# Uploading Files

Upload any type of file to decentralized storage with automatic redundancy and CDN delivery.

## Basic File Upload

Upload a file from a file input:

```tsx
// IMPORTANT: Use thirdweb v5 function-based API (NOT v4 class-based)
import { createThirdwebClient } from 'thirdweb';
import { upload } from 'thirdweb/storage';

// Create thirdweb client for storage operations
const client = createThirdwebClient({
  clientId: process.env.NEXT_PUBLIC_THIRDWEB_CLIENT_ID,
});

// Get file from input
const fileInput = document.querySelector('input[type="file"]');
const file = fileInput.files[0];

// Upload to IPFS using thirdweb v5
const uri = await upload({
  client,
  files: [file],
});

console.log('IPFS URI:', uri);
// Returns: ipfs://bafybei... (IPFS content identifier)

// Convert to gateway URL for browser access
const gatewayUrl = uri.replace('ipfs://', 'https://ipfs.thirdwebcdn.com/ipfs/');
console.log('Gateway URL:', gatewayUrl);
```

## Upload Result

thirdweb v5 upload returns an IPFS URI string:

```tsx
// Upload returns a string URI
const uri = await upload({ client, files: [file] });
// Returns: "ipfs://bafybei..."

// For multiple files, returns array of URIs
const uris = await upload({ client, files: [file1, file2, file3] });
// Returns: ["ipfs://bafybei...", "ipfs://bafybei...", "ipfs://bafybei..."]

// Convert URI to gateway URL for display/access
function getGatewayUrl(ipfsUri: string): string {
  return ipfsUri.replace('ipfs://', 'https://ipfs.thirdwebcdn.com/ipfs/');
}
```

## Upload JSON Data

Store structured data:

```tsx
const userData = {
  name: 'John Doe',
  email: 'john@example.com',
  preferences: {
    theme: 'dark',
    notifications: true,
  },
};

// Upload JSON data as a file
const uri = await upload({
  client,
  files: [userData], // thirdweb v5 automatically converts objects to JSON
});

console.log('IPFS URI:', uri);
// Convert to gateway URL for access
const gatewayUrl = uri.replace('ipfs://', 'https://ipfs.thirdwebcdn.com/ipfs/');
console.log('Data URL:', gatewayUrl);
```

## Upload NFT Metadata

For NFT applications, upload image first, then metadata:

```tsx
// Step 1: Upload the image file
const imageUri = await upload({
  client,
  files: [imageFile],
});

// Step 2: Upload metadata with the image URI
const metadata = {
  name: 'My NFT #1',
  description: 'A unique digital collectible',
  image: imageUri, // Reference to uploaded image
  attributes: [
    { trait_type: 'Color', value: 'Blue' },
    { trait_type: 'Size', value: 'Large' },
  ],
};

const metadataUri = await upload({
  client,
  files: [metadata],
});

console.log('Token URI:', metadataUri);
// This URI can be used as the tokenURI in your NFT contract
```

## Batch Upload

Upload multiple files at once:

```tsx
const files = [file1, file2, file3];

// Upload multiple files in one call
const uris = await upload({
  client,
  files: files,
});

console.log('Total files uploaded:', uris.length);

// Process each uploaded file
uris.forEach((uri, index) => {
  const gatewayUrl = uri.replace('ipfs://', 'https://ipfs.thirdwebcdn.com/ipfs/');
  console.log(`File ${index + 1}: ${gatewayUrl}`);
});
```

## Upload from Blob

Create and upload data programmatically:

```tsx
// Text file from Blob
const textBlob = new Blob(['Hello, World!'], { type: 'text/plain' });
const textUri = await upload({ client, files: [textBlob] });

// JSON data (can pass object directly)
const jsonData = { hello: 'world' };
const jsonUri = await upload({ client, files: [jsonData] });

// Canvas to image
const canvas = document.querySelector('canvas');
canvas.toBlob(async (blob) => {
  const imageUri = await upload({ client, files: [blob] });
  const gatewayUrl = imageUri.replace('ipfs://', 'https://ipfs.thirdwebcdn.com/ipfs/');
  console.log('Canvas uploaded:', gatewayUrl);
}, 'image/png');
```

## Storage Provider

thirdweb v5 uploads to IPFS by default with automatic pinning:

```tsx
// All uploads go to IPFS
const uri = await upload({ client, files: [file] });
// Returns: ipfs://bafybei...
```

<Aside type="tip">
**Automatic pinning** - IPFS uploads are automatically pinned by thirdweb's infrastructure. Your files won't disappear.
</Aside>

**Why IPFS?**
- Fast, distributed storage
- Content-addressed (files never break)
- Automatic redundancy across multiple nodes
- Perfect for most use cases including NFTs

## Error Handling

Handle upload errors gracefully:

```tsx
async function safeUpload(file: File) {
  try {
    const uri = await upload({ client, files: [file] });
    return { success: true, uri };
  } catch (error) {
    const message = error instanceof Error ? error.message : 'Unknown error';

    if (message.includes('File too large')) {
      return { success: false, error: 'File exceeds size limit' };
    }
    if (message.includes('Network') || message.includes('fetch')) {
      return { success: false, error: 'Network error. Please try again.' };
    }
    if (message.includes('client')) {
      return { success: false, error: 'Invalid client ID. Check your configuration.' };
    }

    return { success: false, error: 'Upload failed. Please try again.' };
  }
}
```

## Next Steps

- [Retrieve Files](/build/storage/retrieve) - Download and display files
- [Payments Quick Start](/build/payments/quickstart) - Accept payments
