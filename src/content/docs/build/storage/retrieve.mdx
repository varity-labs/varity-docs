---
title: Retrieving Files
description: Download and display files from storage
---

import Accordion from '../../../../components/Accordion.astro';

# Retrieving Files

Access your stored files via fast CDN delivery.

## Display Uploaded Files

When you upload a file, you get back a permanent HTTPS URL. Use it directly:

```tsx
import { createVaritySDK } from '@varity-labs/sdk';

const sdk = createVaritySDK({
  network: 'arbitrum-l3-testnet',
});

// Upload returns a permanent URL
const result = await sdk.storage.upload(file);

// Use the URL directly in your app
<img src={result.url} alt="Uploaded file" />
```

## Display Images

Display uploaded images in your app:

```tsx title="components/StoredImage.tsx"
export function StoredImage({ imageUrl }: { imageUrl: string }) {
  return (
    <img
      src={imageUrl}
      alt="Stored image"
      loading="lazy"
    />
  );
}
```

## Optimized Images

Get resized and optimized images for faster loading:

```tsx
import { createVaritySDK } from '@varity-labs/sdk';

const sdk = createVaritySDK({
  network: 'arbitrum-l3-testnet',
});

// Resize to specific dimensions
const thumbnailUrl = sdk.storage.getOptimizedUrl(imageUrl, {
  width: 200,
  height: 200,
});

// High quality for detail view
const fullUrl = sdk.storage.getOptimizedUrl(imageUrl, {
  width: 1200,
  quality: 90,
});

// WebP format for smaller file sizes
const webpUrl = sdk.storage.getOptimizedUrl(imageUrl, {
  width: 800,
  format: 'webp',
  quality: 80,
});
```

### Image Options

| Option | Type | Description |
|--------|------|-------------|
| `width` | number | Target width (maintains aspect ratio) |
| `height` | number | Target height (maintains aspect ratio) |
| `quality` | number | Image quality (1-100) |
| `format` | string | Output format: `webp`, `jpeg`, `png`, `avif` |

## Download JSON Data

Retrieve and parse stored JSON data:

```tsx
const userData = await sdk.storage.downloadJSON(dataUrl);

console.log('Name:', userData.name);
console.log('Email:', userData.email);
```

### With TypeScript

Type your downloaded data:

```tsx
interface UserData {
  name: string;
  email: string;
  preferences: {
    theme: 'light' | 'dark';
    notifications: boolean;
  };
}

const userData = await sdk.storage.downloadJSON<UserData>(dataUrl);
```

## Download Files

Download raw file data:

```tsx
const response = await sdk.storage.downloadFile(fileUrl);

// Get as blob
const blob = await response.blob();

// Get as text
const text = await response.text();

// Get as array buffer
const buffer = await response.arrayBuffer();
```

## Image Gallery Example

Complete gallery component with optimized loading:

```tsx title="components/ImageGallery.tsx"
import { useState } from 'react';
import { createVaritySDK } from '@varity-labs/sdk';

const sdk = createVaritySDK({
  network: 'arbitrum-l3-testnet',
});

export function ImageGallery({ imageUrls }: { imageUrls: string[] }) {
  const [selected, setSelected] = useState<string | null>(null);

  return (
    <div>
      {/* Thumbnail grid */}
      <div className="grid grid-cols-4 gap-2">
        {imageUrls.map((url, index) => (
          <img
            key={index}
            src={sdk.storage.getOptimizedUrl(url, {
              width: 200,
              height: 200,
              format: 'webp',
            })}
            alt={`Image ${index + 1}`}
            onClick={() => setSelected(url)}
            className="cursor-pointer rounded"
          />
        ))}
      </div>

      {/* Full size modal */}
      {selected && (
        <div
          className="fixed inset-0 bg-black/80 flex items-center justify-center"
          onClick={() => setSelected(null)}
        >
          <img
            src={sdk.storage.getOptimizedUrl(selected, {
              width: 1200,
              quality: 90,
            })}
            alt="Full size"
            className="max-w-full max-h-full"
          />
        </div>
      )}
    </div>
  );
}
```

## Item Metadata Display

Display item data from stored metadata:

```tsx title="components/ItemCard.tsx"
import { useState, useEffect } from 'react';
import { createVaritySDK } from '@varity-labs/sdk';

const sdk = createVaritySDK({
  network: 'arbitrum-l3-testnet',
});

export function ItemCard({ metadataUrl }: { metadataUrl: string }) {
  const [metadata, setMetadata] = useState<any>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    async function loadMetadata() {
      try {
        const data = await sdk.storage.downloadJSON(metadataUrl);
        setMetadata(data);
      } catch (error) {
        console.error('Failed to load metadata:', error);
      } finally {
        setLoading(false);
      }
    }
    loadMetadata();
  }, [metadataUrl]);

  if (loading) return <div>Loading...</div>;
  if (!metadata) return <div>Failed to load</div>;

  return (
    <div className="rounded-xl overflow-hidden shadow-lg">
      <img
        src={sdk.storage.getOptimizedUrl(metadata.image, { width: 400 })}
        alt={metadata.name}
      />
      <div className="p-4">
        <h3 className="font-bold">{metadata.name}</h3>
        <p className="text-gray-600">{metadata.description}</p>

        {metadata.attributes && (
          <div className="mt-2 flex flex-wrap gap-2">
            {metadata.attributes.map((attr: any, i: number) => (
              <span key={i} className="bg-gray-100 px-2 py-1 rounded text-sm">
                {attr.trait_type}: {attr.value}
              </span>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}
```

<Accordion title="Advanced: Direct Storage API">

For lower-level control, you can work with storage URIs directly:

```tsx
import { createStorageClient, StorageClient } from '@varity-labs/sdk';

// Convert an IPFS URI to an accessible gateway URL
const url = storage.getGatewayUrl('ipfs://QmXxx...');
// https://gateway.thirdwebcdn.com/ipfs/QmXxx...

// Static method
const url = StorageClient.resolveUri('ipfs://QmXxx...');

// Download JSON from IPFS URI
const data = await storage.downloadJSON('ipfs://QmXxx...');

// Download raw file from IPFS URI
const response = await storage.downloadFile('ipfs://QmXxx...');
```

This gives you direct access to IPFS URIs and custom gateway configuration for advanced use cases.

</Accordion>

## Next Steps

- [Payments Quick Start](/build/payments/quickstart) - Accept payments
- [Authentication Quick Start](/build/auth/quickstart) - Set up login
